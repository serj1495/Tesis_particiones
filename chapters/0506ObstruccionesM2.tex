El primer paso en nuestro estudio de la clase $M_2$ es caracterizar a la
misma a través de su conjunto de obstrucciones mínimas, lo cual se realiza 
en el Teorema \ref{teo_obsts_m2}, cuya demostración requiere del Teorema
\ref{teo_paw} y del Lema \ref{lema_bipartitas}. Recordemos que
la gr\'afica conocida como \textbf{\emph{Paw}} es la gr\'afica obtenida de
$K_3$ al agregar un v\'ertice nuevo y hacerlo adyacente a exactamente un
v\'ertice de $K_3$, o bien $K_1 \oplus (K_1 + K_2)$.

\begin{theorem}[\cite{Olariu}] \label{teo_paw}
	Sea $G$ una gráfica perfecta, $G$ es libre de $Paw$ si y sólo si cada componente de $G$ es libre de $K_3$ o multipartita completa.
\end{theorem}

Aplicando este teorema, podemos concluir lo siguiente. Dado que las cográficas son gráficas perfectas y toda cográfica libre de $K_3$ es bipartita, si una cográfica $G$ es libre de $Paw$, entonces $G$ es bipartita o multipartita completa.

\begin{lemma} \label{lema_bipartitas}
Sea $G$ una cográfica conexa. Si $G$ es bipartita, entonces $G$ es bipartita completa.
\end{lemma}

\begin{proof}
Sea $r$ la raíz del coárbol de $G$. Si $G$ es trivial, es claro que $G$ es bipartita completa. En el caso contrario, $r$ tiene etiqueta 1. Como $G$ es bipartita, entonces es libre de $K_3$. Luego, $r$ tiene exactamente dos hijos, ninguno de los cuales puede contener un $K_2$. Así cada uno de los hijos de $r$ representa a un conjunto independiente. Luego, $G$ es la unión completa de dos conjuntos independientes. Es decir, $G$ es una gráfica bipartita completa.
\end{proof}

\begin{theorem} \label{teo_obsts_m2}

    Para una cográfica $G$, las siguientes afirmaciones son equivalentes.
    \begin{enumerate}[(a)]
        \item $G \in M_2$.
        \item $G$ no contiene a ninguna de las gráficas de las Figuras \ref{obsts_M2} como subgráficas inducidas.
    \end{enumerate}

\end{theorem}

\begin{figure}[ht!]
\begin{center}
\begin{tikzpicture}

\begin{scope}[xshift=0cm,scale=1]

\node [style=vertex] (1) at (0,0) {};
\node [style=vertex] (2) at (1,0) {};
\node [style=vertex] (3) at (0,0.5) {};
\node [style=vertex] (4) at (1,0.5) {};
\node [style=vertex] (5) at (0.5,1.25) {};
\node [style=vertex] (6) at (0.5,2) {};
\foreach \i/\j in {1/2,3/4,3/5,4/5}
  \draw [style=edge] (\i) to (\j);
\node [below of=1,xshift=.5cm]
{\parbox{0.3\linewidth}{\subcaption*{$H$}}};

\end{scope}

\begin{scope}[xshift=3cm,scale=1]

\node [style=vertex] (1) at (0,0) {};
\node [style=vertex] (2) at (1,0) {};
\node [style=vertex] (3) at (0,0.5) {};
\node [style=vertex] (4) at (1,0.5) {};
\node [style=vertex] (5) at (0.5,1.25) {};
\node [style=vertex] (6) at (0.5,2) {};
\foreach \i/\j in {1/2,3/4,3/5,4/5,5/6}
  \draw [style=edge] (\i) to (\j);
\node [below of=1,xshift=.5cm]  {\parbox{0.3\linewidth}{\subcaption*{$I$}}};

\end{scope}

\begin{scope}[xshift=6cm,scale=1]

\node [style=vertex] (1) at (0,0) {};
\node [style=vertex] (2) at (0.5,0.5) {};
\node [style=vertex] (3) at (1.5,0.5) {};
\node [style=vertex] (4) at (0.5,1.5) {};
\node [style=vertex] (5) at (1.5,1.5) {};
\node [style=vertex] (6) at (0,2) {};
\node [style=vertex] (7) at (2,1) {};

\foreach \i/\j in {1/2,1/3,1/6,2/3,2/4,2/5,3/4,3/5,4/5,4/6,5/6}
  \draw [style=edge] (\i) to (\j);
\node [below of=1,xshift=1cm] {\parbox{0.3\linewidth}{\subcaption*{$J$}}};

\end{scope}
\end{tikzpicture}
\end{center}
\setlength{\abovecaptionskip}{-15pt}
\caption{Obstrucciones mínimas para la clase $M_2$.}
\label{obsts_M2}
\end{figure}

\begin{proof}

  Notemos que las gráficas $H, I$ y $J$ pueden ser construidas de la siguiente manera:

  \begin{enumerate}[(1)]
      \item $H = K_1 + K_2 + K_3$.
      \item $I = Paw + K_2$.
      \item $J = (\overline{P_3} \oplus \overline{P_3}) + K_1$.
  \end{enumerate}

  Supongamos primero que $G \in M_2$ y procedamos probando la contrapositiva
  de la afirmación. Es decir, probemos que que si $G$ tiene a $H$, a $I$
  o a $J$ como subgráficas inducidas, entonces $G \notin M_2$.
  Veamos que ninguna partici\'on en dos partes de $G$ es una $M_2$-partici\'on.
  
  Sea $(X,Y)$ una partici\'on de $G$. Si $G$ tiene a $H$ como subgráfica inducida a $H$. Si ambos vértices de $K_2$ en $H$
  se encuentran en $X$, entonces la existencia de cualquier vértice adicional
  en $X$, implicar\'ia que $G[X]$ contiene un $\overline{P_3}$. Como los
  vértices restantes inducen una gráfica que no es multipartita completa,
  esta partici\'on no es una $M_2$-partici\'on. Supongamos entonces que un
  v\'ertice de $K_2$ est\'a en $X$ y el otro en $Y$. Como la gráfica inducida
  por los vértices restantes de $H$ contiene un $K_3$, podemos suponer sin
  p\'erdida de generalidad que dos de sus v\'ertices se encuentran en $X$,
  por lo que $X$ contiene una copia inducida de $\overline{P_3}$. Como la
  partici\'on fue elegida arbitrariamente, tenemos que $H$ no pertenece a
  $M_2$. El argumento para probar que $I$ no está en $M_2$ es an\'algo al
  anterior.

  Si $G$ tiene a $J$ como subgráfica inducida, como $J$ tiene un vértice aislado, para que admitiera
  una $M_2$-partici\'on, el resto de sus vértices (que inducen un
  $\overline{P_3} \oplus \overline{P_3}$) deben de poder dividirse en dos
  partes de manera tales que una induzca un conjunto independiente y la otra
  una gráfica multipartita completa. Siempre que tomamos uno de los vértices
  de uno de los dos $\overline{P_3}$ para formar el conjunto independiente,
  ninguno los vértices del otro $\overline{P_3}$ puede ser agregado al mismo,
  pues es adyacente al vértice que agregamos primero. Así, la subgráfica
  inducida $\overline{P_3} \oplus \overline{P_3}$ no acepta una partición en
  un conjunto independiente y una gráfica multipartita completa. Luego, $J$
  no está en $M_2$.

  Recíprocamente, supongamos que $G$ es libre de $H$, $I$ y $J$ y probemos
  que es elemento de $M_2$. Para ello consideramos
  cuatro casos que son exhaustivos. Los primeros tres casos cubren toda
  situación en la que $G$ es inconexa, mientras que el último caso se cumple
  si $G$ es conexa.

  \emph{Caso 1:} $G$ tiene al menos dos componentes conexas no triviales.

  Consideremos la partición de $V$ en dos partes $(A,B)$ tal que $A$ contiene
  únicamente una componente no trivial y $B$ el resto. Como $G[A]$ y $G[B]$
  contienen ambas componentes no triviales, las dos poseen un $K_2$. Luego,
  ni $G[B]$ ni $G[A]$ pueden contener un $Paw$, o $G$ tendría a $I$ como
  subgráfica inducida. Dado que $G[A]$ y $G[B]$ son cográficas, son también
  gráficas perfectas, y al ninguna tener un $Paw$ como subgráfica inducida,
  cada una es bipartita o multipartita completa \cite{Olariu}.

  % Realmente no se acostumbra a argumentar así cuando usas un resultado
  % de alguien más.  Lo común es escribir el teorema, citando la fuente
  % (algo como \begin{theorem}[\cite{Olariu}] ...), etiquetarlo, y referirte
  % al teorema dentro de tu trabajo.   De otra forma, le estás dejando al
  % lector el trabajo de buscar el artículo, y tratar de adivinar qué
  % resultado estás aplicando.

  Si tanto $G[A]$ como $G[B]$ son gráficas multipartitas completas,
  entonces $G \in M_2$. Si ambas son bipartitas, entonces $G$ es bipartita
  también y acepta una partición en dos conjuntos independientes, cada uno
  de los cuales es una gráfica multipartita completa, por lo que $G \in M_2$.
  Si $G[A]$ es bipartita y $G[B]$ es multipartita completa, como $G[A]$ es
  una cográfica conexa, entonces es una gráfica multipartita completa y $G
  \in M_2$.

  % El último enunciado necesita una referencia al resultado de que toda
  % cográfica bipartita es bipartita completa.   Que por cierto, no recuerdo
  % haber visto.   Creo que eso es algo que podría ir en el capítulo de
  % antecedentes, sección de cográficas.

  Finalmente, si $G[A]$ es multipartita completa y $G[B]$ es bipartita. Si
  $G[B]$ tiene una sola componente, $G[B]$ es bipartita completa y $G \in
  M_2$. Si $G[B]$ tiene más de una componente, como al menos una es no
  trivial, debe tener a $\overline{P_3}$ como subgráfica inducida. Luego,
  $G[A]$ debe ser libre de $K_3$ o $G$ tendría a $H$ como subráfica inducida.
  Así, $G[A]$ es bipartita. Como ambas son bipartitas, $G \in M_2$.


  \emph{Caso 2:} $G$ tiene exactamente una componente conexa no trivial y
  al menos una trivial.

  Como $G$ contiene al menos una componente trivial, la única partición que
  puede aceptar en dos gráficas multipartitas completas es una partición en
  un conjunto independiente y una gráfica multipartita completa. Luego, la
  componente no trivial de $G$, a la que llamaremos $G'$, debe de aceptar una
  partición en un conjunto independiente y una gráfica multipartita completa.

  Si $G'$ es bipartita, entonces acepta una partición en dos conjuntos
  independientes, y por lo tanto $G \in M_2$. Si $G'$ es una gráfica
  multipartita completa, entonces $G \in M_2$. Si $G$ no es una gráfica
  bipartita ni multipartita completa, dado que es una cográfica, y por lo
  tanto una gráfica perfecta, $G$ contiene un $Paw$. Sea $y$ la raíz del
  coárbol de $G'$ y sea $z$, descendiente de $y$, el nodo más profundo que
  tiene un $Paw$ como subgráfica inducida, probemos por inducción sobre la
  distancia desde $y$ hasta $z$, denotada por $d$, que $G'[y]$ acepta una
  partición en un conjunto independiente y una gráfica multipartita completa.

  \textbf{Caso base}: $d = 0$, o bien, $y = z$.

  Notemos que $z$ tiene etiqueta 1, pues $Paw$ es una gráfica conexa. Dado
  que $z$ tiene etiqueta 1, todos sus hijos inducen gráficas multipartitas
  completas menos uno, $w$, que tiene etiqueta 0. Mostremos por contradicción
  que todos los hijos de $w$ inducen gráficas multipartitas completas.
  Supongamos que alguno de los hijos de $w$ contiene un $\overline{P_3}$.
  Como el nodo más profundo que contiene un $\overline{P_3}$ debe tener
  etiqueta 0, $w$ tiene un hijo de etiqueta 1 y éste a su vez tiene al menos
  2 hijos, uno de los cuales contiene a $\overline{P_3}$ y el otro que tiene
  al menos un $K_1$. Luego, dicho hijo contiene un $Paw$, lo que es una
  contradicción.

  Si $w$ tiene un sólo hijo que no es un vértice, el resto de sus hijos
  forman un conjunto independiente, $C$. Si eliminamos este conjunto
  independiente, como el único hijo de $w$ que queda induce una gráfica
  multipartita completa, entonces $G'[w] - C$ es una gráfica multipartita
  completa. Luego, $G'[z] - C$ es la unión completa de varias gráficas
  multipartitas completas y por lo tanto es una gráfica multipartita
  completa. De esto se sigue que $G[z]$ acepta una partición en un conjunto
  independiente, $C$, y una gráfica multipartita completa $G'[z] - C$.

  Si $w$ tiene al menos dos hijos no triviales, notemos que ninguno de
  ellos puede contener a $K_3$, o de lo contrario $w$ contendría a $K_2+K_3$
  y $G$ no sería libre de $I$. Luego, todos los hijos de $w$ inducen gráficas
  bipartitas, es decir que $w$ induce también una gráfica bipartita. En otras
  palabras, $G'[w]$ acepta una partición en dos conjuntos independientes. Si
  sustraemos uno de estos conjuntos independientes, denotado por $D$, entonces
  $G'[w]-D$ es un conjunto independiente. Luego $G'[z]-D$ es la unión completa
  de al menos una gráfica multipartita completa y un conjunto independiente.
  Así, $G'[z]-D$ es una gráfica multipartita completa. Luego, $G'[z]$ acepta
  una partición en un conjunto independiente, $D$ y una gráfica multipartita
  completa, $G'[z] - D$.

  Como en todos los casos $z$ acepta una partición en un conjunto
  independiente y una gráfica multipartita completa y $y = z$, entonces $y$
  acepta la misma partición.

  \textbf{Paso inductivo}: $d \ge 2$.

  Notemos que $d$ siempre será par, ya que tanto $y$ como $z$ son nodos con
  etiqueta 1. Sea $k$ un entero tal que $k \ge 2$. Supongamos, como hipótesis
  inductiva, que si $G''$ es una cográfica conexa libre de $H, I$ y $J$ tal
  que la distancia, $d'$, entre la raíz, $y'$ de su coárbol y el nodo más
  profundo que contiene un $Paw$ es igual a $k-2$, entonces $G''$ acepta una
  partición en un conjunto independiente y una gráfica multipartita completa.

  Dado que $G'$ es libre de $J$, todos los hijos de $y$, menos uno, inducen
  gráficas multipartitas completas. Dicho hijo, $v$, tiene etiqueta 0 y al
  menos uno de sus hijos debe de contener un $Paw$. Denotemos a dicho hijo
  como $u$. El resto de los hijos de $v$ deben de ser vértices, o de lo
  contrario, $G'[v]$ contendría a $K_2 + K_3$ como subgráfica inducida, por
  lo que $G$ contendría a $I$. Denotemos a este conjunto de vértices como
  $E$. Luego, $G'[u]$  es una cográfica que cumple con las condiciones de
  la hipótesis inductiva, por lo que acepta una partición en un conjunto
  independiente, $D$ y una gráfica multipartita completa. Tenemos entonces
  que $G'[u] - D$ es una gráfica multipartita completa. Se sigue que
  $(G'[v]-D)-E$ es una gráfica multipartita completa. Luego, $(G'-D)-E$ es
  una unión completa de gráficas multipartitas completas por lo que también
  es una gráfica multipartita completa. Notemos que, dado que $v$ tiene
  etiqueta 0, no existen aristas entre los vértices en $D$ y los vértices en
  $E$, es decir que $D \cup E$ es un conjunto independiente. Así, $G'$ acepta
  una partición en un conjunto independiente, $D \cup E$ y una gráfica
  multipartita completa, $(G' - D) - E$.

  Como $G'$ acepta una partición en un conjunto independiente y una gráfica
  multipartita completa, entonces $G \in M_2$.


  \emph{Caso 3:} $G$ es un conjunto independiente con al menos dos vértices.

  Dado que $G$ es una gráfica multipartita completa, se sigue inmediatamente
  que está en $M_2$.

  \emph{Caso 4:} $G$ es conexa.

  Dado que toda cográfica inconexa libre de $H$, $I$ y $J$ acepta una
  partición en dos gráficas multipartitas completas, y como una cográfica
  conexa es o un vértice aislado o una unión completa de cográficas
  inconexas se sigue de los casos anteriores y del hecho de que la clase
  $M_2$ es cerrada bajo uniones completas (Lema
  \ref{lema_union_completa}), que $G \in M_2$.

\end{proof}
